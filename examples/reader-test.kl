#lang "prelude.kl"

(import "list.kl")
(import "reader.kl")


(define once
  (reader (lambda (r) r)))

(define twice
  (reader (lambda (r) (* 2 r))))

(define thrice
  (reader (lambda (r) (* 3 r))))

(define four-times
  (reader-ap (reader-ap (reader-pure +)
                        twice)
             twice))

(define five-times
  (reader-ap (reader-ap (reader-pure +)
                        twice)
             thrice))

(define six-times
  (reader-ap (reader-ap (reader-pure +)
                        thrice)
             thrice))

(example
  (map (lambda (n-times)
         (run-reader n-times 10))
       (list once twice thrice four-times five-times six-times)))
