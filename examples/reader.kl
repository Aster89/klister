#lang "prelude.kl"


(datatype (Reader r a)
  (reader (-> r a)))

(defun run-reader (reader-a r)
  (case reader-a
    [(reader f)
     (f r)]))

(defun reader-pure (a)
  (reader (lambda (_) a)))

(defun reader-ap (readerF readerA)
  (reader
    (lambda (r)
      ((run-reader readerF r)
       (run-reader readerA r)))))


(export Reader reader run-reader reader-pure reader-ap)
